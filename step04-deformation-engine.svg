<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 840" width="1800" height="840">
  <defs>
    <linearGradient id="bgGrad4" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0a0a0f"/>
      <stop offset="100%" style="stop-color:#12121a"/>
    </linearGradient>
    <linearGradient id="neuralGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#7c3aed"/>
      <stop offset="50%" style="stop-color:#00d4ff"/>
      <stop offset="100%" style="stop-color:#10b981"/>
    </linearGradient>
    <radialGradient id="neuralCore" cx="50%" cy="50%" r="50%">
      <stop offset="0%" style="stop-color:#00d4ff;stop-opacity:0.3"/>
      <stop offset="70%" style="stop-color:#7c3aed;stop-opacity:0.15"/>
      <stop offset="100%" style="stop-color:#0a0a0f;stop-opacity:0"/>
    </radialGradient>
    <filter id="glow4" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
    <filter id="neuralGlow" x="-100%" y="-100%" width="300%" height="300%">
      <feGaussianBlur stdDeviation="12" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
    <pattern id="grid4" width="40" height="40" patternUnits="userSpaceOnUse">
      <path d="M 40 0 L 0 0 0 40" fill="none" stroke="#1e1e2e" stroke-width="0.5"/>
    </pattern>
  </defs>
  
  <rect width="1800" height="840" fill="url(#bgGrad4)"/>
  <rect width="1800" height="840" fill="url(#grid4)" opacity="0.4"/>
  
  <text x="900" y="60" font-family="'SF Mono', 'Fira Code', monospace" font-size="28" fill="#00d4ff" text-anchor="middle" font-weight="600" filter="url(#glow4)">STEP 04: DEFORMATION ENGINE</text>
  <text x="900" y="90" font-family="'SF Mono', 'Fira Code', monospace" font-size="14" fill="#6b7280" text-anchor="middle">Neural Network Surrogate for Physics Simulation Acceleration</text>
  
  <!-- Left Panel: INPUTS -->
  <g transform="translate(80, 140)">
    <rect x="0" y="0" width="340" height="360" rx="8" fill="#1a1a2e" stroke="#f59e0b" stroke-width="2"/>
    <rect x="0" y="0" width="340" height="42" rx="8" fill="#f59e0b" opacity="0.15"/>
    <text x="20" y="28" font-family="'SF Mono', 'Fira Code', monospace" font-size="16" fill="#f59e0b" font-weight="600">INPUTS</text>
    
    <g transform="translate(20, 60)">
      <rect x="0" y="0" width="300" height="50" rx="5" fill="#0d0d15" stroke="#f59e0b" stroke-width="1"/>
      <text x="15" y="20" font-family="'SF Mono', 'Fira Code', monospace" font-size="12" fill="#00d4ff">material_bucket</text>
      <text x="15" y="38" font-family="'SF Mono', 'Fira Code', monospace" font-size="10" fill="#6b7280">From Step 03 material inference</text>
    </g>
    
    <g transform="translate(20, 120)">
      <rect x="0" y="0" width="300" height="50" rx="5" fill="#0d0d15" stroke="#f59e0b" stroke-width="1"/>
      <text x="15" y="20" font-family="'SF Mono', 'Fira Code', monospace" font-size="12" fill="#00d4ff">body_params (SMPL-X)</text>
      <text x="15" y="38" font-family="'SF Mono', 'Fira Code', monospace" font-size="10" fill="#6b7280">Shape β, pose θ, expression ψ</text>
    </g>
    
    <g transform="translate(20, 180)">
      <rect x="0" y="0" width="300" height="50" rx="5" fill="#0d0d15" stroke="#f59e0b" stroke-width="1"/>
      <text x="15" y="20" font-family="'SF Mono', 'Fira Code', monospace" font-size="12" fill="#00d4ff">pose (from IK)</text>
      <text x="15" y="38" font-family="'SF Mono', 'Fira Code', monospace" font-size="10" fill="#6b7280">Joint rotations, orientation</text>
    </g>
    
    <g transform="translate(20, 240)">
      <rect x="0" y="0" width="300" height="50" rx="5" fill="#0d0d15" stroke="#f59e0b" stroke-width="1"/>
      <text x="15" y="20" font-family="'SF Mono', 'Fira Code', monospace" font-size="12" fill="#00d4ff">garment_pattern</text>
      <text x="15" y="38" font-family="'SF Mono', 'Fira Code', monospace" font-size="10" fill="#6b7280">2D pattern, seam topology</text>
    </g>
    
    <text x="20" y="320" font-family="'SF Mono', 'Fira Code', monospace" font-size="10" fill="#6b7280">Latent embedding: 512-dim vector</text>
    <text x="20" y="340" font-family="'SF Mono', 'Fira Code', monospace" font-size="10" fill="#6b7280">Batch processing supported</text>
  </g>
  
  <!-- Flow Arrows Left -->
  <g transform="translate(440, 320)">
    <path d="M0,0 L120,0" stroke="#10b981" stroke-width="3" fill="none"/>
    <polygon points="120,-8 140,0 120,8" fill="#10b981"/>
    <text x="70" y="-15" font-family="'SF Mono', 'Fira Code', monospace" font-size="10" fill="#6b7280" text-anchor="middle">ENCODE</text>
  </g>
  
  <!-- Center: Neural Network Core -->
  <g transform="translate(900, 320)">
    <ellipse cx="0" cy="0" rx="280" ry="200" fill="url(#neuralCore)" filter="url(#neuralGlow)"/>
    <ellipse cx="0" cy="0" rx="220" ry="160" fill="#1a1a2e" stroke="url(#neuralGrad)" stroke-width="3"/>
    <ellipse cx="0" cy="0" rx="160" ry="110" fill="none" stroke="#00d4ff" stroke-width="1" opacity="0.3"/>
    <ellipse cx="0" cy="0" rx="100" ry="70" fill="none" stroke="#7c3aed" stroke-width="1" opacity="0.4"/>
    
    <!-- Neural network nodes -->
    <circle cx="-120" cy="-60" r="12" fill="#f59e0b" opacity="0.8"/>
    <circle cx="-120" cy="0" r="12" fill="#f59e0b" opacity="0.8"/>
    <circle cx="-120" cy="60" r="12" fill="#f59e0b" opacity="0.8"/>
    
    <circle cx="-40" cy="-80" r="10" fill="#7c3aed" opacity="0.8"/>
    <circle cx="-40" cy="-30" r="10" fill="#7c3aed" opacity="0.8"/>
    <circle cx="-40" cy="20" r="10" fill="#7c3aed" opacity="0.8"/>
    <circle cx="-40" cy="70" r="10" fill="#7c3aed" opacity="0.8"/>
    
    <circle cx="40" cy="-60" r="10" fill="#00d4ff" opacity="0.8"/>
    <circle cx="40" cy="-10" r="10" fill="#00d4ff" opacity="0.8"/>
    <circle cx="40" cy="40" r="10" fill="#00d4ff" opacity="0.8"/>
    
    <circle cx="120" cy="-30" r="12" fill="#10b981" opacity="0.8"/>
    <circle cx="120" cy="30" r="12" fill="#10b981" opacity="0.8"/>
    
    <!-- Connections -->
    <line x1="-108" y1="-60" x2="-50" y2="-80" stroke="#6b7280" stroke-width="1" opacity="0.4"/>
    <line x1="-108" y1="-60" x2="-50" y2="-30" stroke="#6b7280" stroke-width="1" opacity="0.4"/>
    <line x1="-108" y1="0" x2="-50" y2="-30" stroke="#6b7280" stroke-width="1" opacity="0.4"/>
    <line x1="-108" y1="0" x2="-50" y2="20" stroke="#6b7280" stroke-width="1" opacity="0.4"/>
    <line x1="-108" y1="60" x2="-50" y2="20" stroke="#6b7280" stroke-width="1" opacity="0.4"/>
    <line x1="-108" y1="60" x2="-50" y2="70" stroke="#6b7280" stroke-width="1" opacity="0.4"/>
    
    <line x1="-30" y1="-80" x2="30" y2="-60" stroke="#6b7280" stroke-width="1" opacity="0.4"/>
    <line x1="-30" y1="-30" x2="30" y2="-60" stroke="#6b7280" stroke-width="1" opacity="0.4"/>
    <line x1="-30" y1="-30" x2="30" y2="-10" stroke="#6b7280" stroke-width="1" opacity="0.4"/>
    <line x1="-30" y1="20" x2="30" y2="-10" stroke="#6b7280" stroke-width="1" opacity="0.4"/>
    <line x1="-30" y1="20" x2="30" y2="40" stroke="#6b7280" stroke-width="1" opacity="0.4"/>
    <line x1="-30" y1="70" x2="30" y2="40" stroke="#6b7280" stroke-width="1" opacity="0.4"/>
    
    <line x1="50" y1="-60" x2="108" y2="-30" stroke="#6b7280" stroke-width="1" opacity="0.4"/>
    <line x1="50" y1="-10" x2="108" y2="-30" stroke="#6b7280" stroke-width="1" opacity="0.4"/>
    <line x1="50" y1="-10" x2="108" y2="30" stroke="#6b7280" stroke-width="1" opacity="0.4"/>
    <line x1="50" y1="40" x2="108" y2="30" stroke="#6b7280" stroke-width="1" opacity="0.4"/>
    
    <!-- Labels -->
    <text x="0" y="-130" font-family="'SF Mono', 'Fira Code', monospace" font-size="18" fill="#00d4ff" text-anchor="middle" font-weight="600" filter="url(#glow4)">NEURAL NET SURROGATE</text>
    <text x="0" y="-105" font-family="'SF Mono', 'Fira Code', monospace" font-size="14" fill="#7c3aed" text-anchor="middle">MLP / GNN</text>
    
    <text x="0" y="130" font-family="'SF Mono', 'Fira Code', monospace" font-size="11" fill="#9ca3af" text-anchor="middle">Predict deformation hints</text>
    <text x="0" y="150" font-family="'SF Mono', 'Fira Code', monospace" font-size="11" fill="#9ca3af" text-anchor="middle">for physics warm-start</text>
  </g>
  
  <!-- Flow Arrows Right -->
  <g transform="translate(1220, 320)">
    <path d="M0,0 L120,0" stroke="#10b981" stroke-width="3" fill="none"/>
    <polygon points="120,-8 140,0 120,8" fill="#10b981"/>
    <text x="70" y="-15" font-family="'SF Mono', 'Fira Code', monospace" font-size="10" fill="#6b7280" text-anchor="middle">DECODE</text>
  </g>
  
  <!-- Right Panel: OUTPUTS -->
  <g transform="translate(1380, 140)">
    <rect x="0" y="0" width="340" height="360" rx="8" fill="#1a1a2e" stroke="#10b981" stroke-width="2"/>
    <rect x="0" y="0" width="340" height="42" rx="8" fill="#10b981" opacity="0.15"/>
    <text x="20" y="28" font-family="'SF Mono', 'Fira Code', monospace" font-size="16" fill="#10b981" font-weight="600">OUTPUTS</text>
    
    <g transform="translate(20, 60)">
      <rect x="0" y="0" width="300" height="70" rx="5" fill="#0d0d15" stroke="#10b981" stroke-width="1"/>
      <text x="15" y="22" font-family="'SF Mono', 'Fira Code', monospace" font-size="12" fill="#00d4ff">warm_start_params</text>
      <text x="15" y="42" font-family="'SF Mono', 'Fira Code', monospace" font-size="10" fill="#6b7280">Initial vertex positions for</text>
      <text x="15" y="57" font-family="'SF Mono', 'Fira Code', monospace" font-size="10" fill="#6b7280">physics simulation bootstrap</text>
    </g>
    
    <g transform="translate(20, 145)">
      <rect x="0" y="0" width="300" height="70" rx="5" fill="#0d0d15" stroke="#10b981" stroke-width="1"/>
      <text x="15" y="22" font-family="'SF Mono', 'Fira Code', monospace" font-size="12" fill="#00d4ff">stability_hints</text>
      <text x="15" y="42" font-family="'SF Mono', 'Fira Code', monospace" font-size="10" fill="#6b7280">Collision-prone regions</text>
      <text x="15" y="57" font-family="'SF Mono', 'Fira Code', monospace" font-size="10" fill="#6b7280">Timestep recommendations</text>
    </g>
    
    <g transform="translate(20, 230)">
      <rect x="0" y="0" width="300" height="50" rx="5" fill="#0d0d15" stroke="#10b981" stroke-width="1"/>
      <text x="15" y="20" font-family="'SF Mono', 'Fira Code', monospace" font-size="12" fill="#00d4ff">deformation_field</text>
      <text x="15" y="38" font-family="'SF Mono', 'Fira Code', monospace" font-size="10" fill="#6b7280">Per-vertex displacement vectors</text>
    </g>
    
    <line x1="20" y1="300" x2="320" y2="300" stroke="#2a2a3e" stroke-width="1"/>
    
    <text x="20" y="325" font-family="'SF Mono', 'Fira Code', monospace" font-size="10" fill="#6b7280">Reduces simulation iterations by ~60%</text>
    <text x="20" y="345" font-family="'SF Mono', 'Fira Code', monospace" font-size="10" fill="#6b7280">Improves draping stability</text>
  </g>
  
  <!-- Bottom: Core Idea Panel -->
  <g transform="translate(80, 550)">
    <rect x="0" y="0" width="800" height="180" rx="8" fill="#1a1a2e" stroke="#7c3aed" stroke-width="2"/>
    <rect x="0" y="0" width="800" height="40" rx="8" fill="#7c3aed" opacity="0.2"/>
    <text x="20" y="27" font-family="'SF Mono', 'Fira Code', monospace" font-size="15" fill="#7c3aed" font-weight="600">CORE IDEA</text>
    
    <text x="30" y="75" font-family="'SF Mono', 'Fira Code', monospace" font-size="13" fill="#00d4ff">Learn deformation patterns from Synthetic Data Factory</text>
    <text x="30" y="100" font-family="'SF Mono', 'Fira Code', monospace" font-size="13" fill="#9ca3af">→ Provide warm-start to physics simulation</text>
    
    <line x1="30" y1="120" x2="770" y2="120" stroke="#2a2a3e" stroke-width="1"/>
    
    <text x="30" y="145" font-family="'SF Mono', 'Fira Code', monospace" font-size="12" fill="#f59e0b">GOAL:</text>
    <text x="90" y="145" font-family="'SF Mono', 'Fira Code', monospace" font-size="12" fill="#9ca3af">Reduce iteration count + stabilize draping quality</text>
    
    <text x="30" y="168" font-family="'SF Mono', 'Fira Code', monospace" font-size="11" fill="#6b7280">(measured in PoC)</text>
  </g>
  
  <!-- Bottom Right: Architecture Details -->
  <g transform="translate(920, 550)">
    <rect x="0" y="0" width="400" height="180" rx="8" fill="#1a1a2e" stroke="#00d4ff" stroke-width="2"/>
    <rect x="0" y="0" width="400" height="40" rx="8" fill="#00d4ff" opacity="0.1"/>
    <text x="20" y="27" font-family="'SF Mono', 'Fira Code', monospace" font-size="15" fill="#00d4ff" font-weight="600">ARCHITECTURE OPTIONS</text>
    
    <text x="30" y="70" font-family="'SF Mono', 'Fira Code', monospace" font-size="12" fill="#7c3aed">MLP</text>
    <text x="80" y="70" font-family="'SF Mono', 'Fira Code', monospace" font-size="11" fill="#9ca3af">: Fast, fixed input size</text>
    
    <text x="30" y="95" font-family="'SF Mono', 'Fira Code', monospace" font-size="12" fill="#7c3aed">GNN</text>
    <text x="80" y="95" font-family="'SF Mono', 'Fira Code', monospace" font-size="11" fill="#9ca3af">: Mesh-aware, variable topology</text>
    
    <text x="30" y="120" font-family="'SF Mono', 'Fira Code', monospace" font-size="12" fill="#7c3aed">Transformer</text>
    <text x="130" y="120" font-family="'SF Mono', 'Fira Code', monospace" font-size="11" fill="#9ca3af">: Attention over vertices</text>
    
    <line x1="30" y1="140" x2="370" y2="140" stroke="#2a2a3e" stroke-width="1"/>
    
    <text x="30" y="165" font-family="'SF Mono', 'Fira Code', monospace" font-size="11" fill="#6b7280">Training: ~100K synthetic draping examples</text>
  </g>
  
  <!-- Far Right: Metrics -->
  <g transform="translate(1360, 550)">
    <rect x="0" y="0" width="360" height="180" rx="8" fill="#1a1a2e" stroke="#10b981" stroke-width="2"/>
    <rect x="0" y="0" width="360" height="40" rx="8" fill="#10b981" opacity="0.15"/>
    <text x="20" y="27" font-family="'SF Mono', 'Fira Code', monospace" font-size="15" fill="#10b981" font-weight="600">PERFORMANCE TARGETS</text>
    
    <text x="30" y="70" font-family="'SF Mono', 'Fira Code', monospace" font-size="12" fill="#00d4ff">Inference</text>
    <text x="130" y="70" font-family="'SF Mono', 'Fira Code', monospace" font-size="12" fill="#fff">: &lt;5ms</text>
    
    <text x="30" y="95" font-family="'SF Mono', 'Fira Code', monospace" font-size="12" fill="#00d4ff">Sim Speedup</text>
    <text x="145" y="95" font-family="'SF Mono', 'Fira Code', monospace" font-size="12" fill="#fff">: 2-3x</text>
    
    <text x="30" y="120" font-family="'SF Mono', 'Fira Code', monospace" font-size="12" fill="#00d4ff">Vertex Error</text>
    <text x="140" y="120" font-family="'SF Mono', 'Fira Code', monospace" font-size="12" fill="#fff">: &lt;5mm avg</text>
    
    <line x1="30" y1="140" x2="330" y2="140" stroke="#2a2a3e" stroke-width="1"/>
    
    <text x="30" y="165" font-family="'SF Mono', 'Fira Code', monospace" font-size="11" fill="#6b7280">Benchmarked on diverse body types</text>
  </g>
</svg>
